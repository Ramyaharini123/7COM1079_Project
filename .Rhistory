sentiment_score = pos_count - neg_count
)
# --- 6. Basic summaries ---
cat("\nValid reviews count:", nrow(dataset), "\n")
cat("\nSummary of numeric rating:\n")
print(summary(dataset$rating))
cat("\nSummary of sentiment scores:\n")
print(summary(dataset$sentiment_score))
# --- 7. Visualisations ---
# Histogram of Ratings
p1 <- ggplot(dataset, aes(x = rating)) +
geom_histogram(binwidth = 1, fill = "steelblue", color = "black", boundary = 0.5) +
scale_x_continuous(breaks = seq(1, 5, 1)) +
labs(title = "Distribution of Customer Ratings",
x = "Rating (1–5 Stars)",
y = "Frequency") +
theme_minimal()
# Scatter Plot of Sentiment vs Rating
p2 <- ggplot(dataset, aes(x = sentiment_score, y = rating)) +
geom_jitter(alpha = 0.5, color = "darkgreen") +
geom_smooth(method = "lm", se = TRUE, color = "red") +
labs(title = "Relationship Between Sentiment and Rating",
x = "Sentiment Score (Keyword-Based)",
y = "Rating (1–5 Stars)") +
theme_light()
print(p1)
print(p2)
# --- 8. Correlation Analysis ---
clean_data <- dataset %>% filter(!is.na(sentiment_score) & !is.na(rating))
if (nrow(clean_data) > 2) {
correlation_result <- cor.test(clean_data$sentiment_score, clean_data$rating, method = "pearson")
cat("\nPearson correlation test result:\n")
print(correlation_result)
} else {
cat("\nNot enough valid observations for correlation test.\n")
}
# --- 9. Save plots for report inclusion ---
ggsave("Histogram_Ratings.png", p1, width = 6, height = 4)
ggsave("Scatter_Sentiment_vs_Rating.png", p2, width = 6, height = 4)
# End of Script
# End of Script
# End of Script
# End of Script
# End of Script
# End of Script
# --- 1. Load required packages ---
required_packages <- c("tidyverse", "stringr", "ggplot2")
new_packages <- required_packages[!(required_packages %in% installed.packages()[,"Package"])]
if(length(new_packages)) install.packages(new_packages)
lapply(required_packages, library, character.only = TRUE)
# --- 2. Load dataset safely with encoding ---
dataset <- read.csv("McDonald_s_Reviews.csv", stringsAsFactors = FALSE, fileEncoding = "latin1")
# --- 3. Clean and prepare data ---
names(dataset) <- trimws(tolower(names(dataset)))
# Convert ratings like "4 stars" → numeric 4
dataset$rating <- str_extract(dataset$rating, "\\d+") %>% as.numeric()
# Remove invalid rows
dataset <- dataset %>%
filter(!is.na(rating) & rating >= 1 & rating <= 5) %>%
filter(!is.na(review) & review != "")
# --- 4. Fix encoding in review text ---
# Convert to ASCII, replacing invalid characters
dataset$review <- iconv(dataset$review, from = "latin1", to = "ASCII", sub = "")
# --- 5. Sentiment scoring using keyword matching ---
positive_words <- c("good","great","excellent","amazing","love","nice","tasty",
"clean","friendly","fast","happy","delicious","awesome","best","fresh")
negative_words <- c("bad","terrible","awful","slow","hate","worst","dirty",
"rude","cold","disappoint","poor","unhappy","unpleasant","stale","overpriced")
dataset <- dataset %>%
mutate(
review_lower = tolower(review),
pos_count = sapply(review_lower, function(x) sum(str_count(x, positive_words))),
neg_count = sapply(review_lower, function(x) sum(str_count(x, negative_words))),
sentiment_score = pos_count - neg_count
)
# --- 6. Basic summaries ---
cat("\nValid reviews count:", nrow(dataset), "\n")
cat("\nSummary of numeric rating:\n")
print(summary(dataset$rating))
cat("\nSummary of sentiment scores:\n")
print(summary(dataset$sentiment_score))
# --- 7. Visualisations ---
# Histogram of Ratings
p1 <- ggplot(dataset, aes(x = rating)) +
geom_histogram(binwidth = 1, fill = "steelblue", color = "black", boundary = 0.5) +
scale_x_continuous(breaks = seq(1, 5, 1)) +
labs(title = "Distribution of Customer Ratings",
x = "Rating (1–5 Stars)",
y = "Frequency") +
theme_minimal()
# Scatter Plot of Sentiment vs Rating
p2 <- ggplot(dataset, aes(x = sentiment_score, y = rating)) +
geom_jitter(alpha = 0.5, color = "darkgreen") +
geom_smooth(method = "lm", se = TRUE, color = "red") +
labs(title = "Relationship Between Sentiment and Rating",
x = "Sentiment Score (Keyword-Based)",
y = "Rating (1–5 Stars)") +
theme_light()
print(p1)
print(p2)
# --- 8. Correlation Analysis ---
clean_data <- dataset %>% filter(!is.na(sentiment_score) & !is.na(rating))
if (nrow(clean_data) > 2) {
correlation_result <- cor.test(clean_data$sentiment_score, clean_data$rating, method = "pearson")
cat("\nPearson correlation test result:\n")
print(correlation_result)
} else {
cat("\nNot enough valid observations for correlation test.\n")
}
# --- 9. Save plots for report inclusion ---
ggsave("Histogram_Ratings.png", p1, width = 6, height = 4)
ggsave("Scatter_Sentiment_vs_Rating.png", p2, width = 6, height = 4)
# --- 1. Load required packages ---
required_packages <- c("tidyverse", "stringr", "ggplot2", "ggpubr")
new_packages <- required_packages[!(required_packages %in% installed.packages()[,"Package"])]
if(length(new_packages)) install.packages(new_packages)
lapply(required_packages, library, character.only = TRUE)
# --- 2. Load dataset safely with encoding ---
dataset <- read.csv("McDonald_s_Reviews.csv", stringsAsFactors = FALSE, fileEncoding = "latin1")
# --- 3. Clean and prepare data ---
names(dataset) <- trimws(tolower(names(dataset)))
# Convert ratings like "4 stars" → numeric 4
dataset$rating <- str_extract(dataset$rating, "\\d+") %>% as.numeric()
# Keep valid rows
dataset <- dataset %>%
filter(!is.na(rating) & rating >= 1 & rating <= 5) %>%
filter(!is.na(review) & review != "")
# Fix encoding and strip special characters
dataset$review <- iconv(dataset$review, from = "latin1", to = "ASCII", sub = "")
# --- 4. Sentiment scoring using keyword matching ---
positive_words <- c("good","great","excellent","amazing","love","nice","tasty",
"clean","friendly","fast","happy","delicious","awesome","best","fresh")
negative_words <- c("bad","terrible","awful","slow","hate","worst","dirty",
"rude","cold","disappoint","poor","unhappy","unpleasant","stale","overpriced")
dataset <- dataset %>%
mutate(
review_lower = tolower(review),
pos_count = sapply(review_lower, function(x) sum(str_count(x, positive_words))),
neg_count = sapply(review_lower, function(x) sum(str_count(x, negative_words))),
sentiment_score = pos_count - neg_count
)
# --- 5. Summaries ---
cat("\nValid reviews count:", nrow(dataset), "\n")
cat("\nSummary of numeric rating:\n")
print(summary(dataset$rating))
cat("\nSummary of sentiment scores:\n")
print(summary(dataset$sentiment_score))
# --- 6. Visualisations ---
# (a) Histogram of Ratings
p1 <- ggplot(dataset, aes(x = rating)) +
geom_histogram(binwidth = 1, fill = "steelblue", color = "black", boundary = 0.5) +
scale_x_continuous(breaks = seq(1, 5, 1)) +
labs(title = "Distribution of Customer Ratings",
x = "Rating (1–5 Stars)",
y = "Frequency") +
theme_minimal()
# (b) Scatter Plot of Sentiment vs Rating
p2 <- ggplot(dataset, aes(x = sentiment_score, y = rating)) +
geom_jitter(alpha = 0.5, color = "darkgreen") +
geom_smooth(method = "lm", se = TRUE, color = "red") +
labs(title = "Relationship Between Sentiment and Rating",
x = "Sentiment Score (Keyword-Based)",
y = "Rating (1–5 Stars)") +
theme_light()
print(p1)
print(p2)
# --- 7. Correlation Analysis ---
clean_data <- dataset %>% filter(!is.na(sentiment_score) & !is.na(rating))
if (nrow(clean_data) > 2) {
correlation_result <- cor.test(clean_data$sentiment_score, clean_data$rating, method = "pearson")
cat("\nPearson correlation test result:\n")
print(correlation_result)
# --- 8. Correlation Visualization ---
# (a) Annotated Scatter Plot with r and p-value
corr_text <- paste0("r = ", round(correlation_result$estimate, 3),
"\n p-value < ", format.pval(correlation_result$p.value, digits = 3))
corr_plot <- ggplot(clean_data, aes(x = sentiment_score, y = rating)) +
geom_point(alpha = 0.4, color = "blue") +
geom_smooth(method = "lm", color = "red", se = TRUE) +
annotate("text", x = Inf, y = Inf, label = corr_text, hjust = 1.1, vjust = 2,
size = 5, color = "black", fontface = "bold") +
labs(title = "Correlation Between Sentiment Score and Rating",
x = "Sentiment Score", y = "Rating (1–5 Stars)") +
theme_classic()
print(corr_plot)
# (b) Simple Correlation Heatmap
corr_matrix <- data.frame(sentiment_score = clean_data$sentiment_score,
rating = clean_data$rating)
corr_value <- round(cor(corr_matrix)[1, 2], 3)
corr_heatmap <- ggplot(data.frame(x = "Sentiment", y = "Rating", corr = corr_value),
aes(x = x, y = y, fill = corr)) +
geom_tile() +
geom_text(aes(label = corr), color = "white", size = 8, fontface = "bold") +
scale_fill_gradient2(low = "red", high = "blue", mid = "white",
midpoint = 0, limit = c(-1, 1)) +
labs(title = "Correlation Heatmap: Sentiment vs Rating",
x = "", y = "") +
theme_minimal() +
theme(axis.text = element_blank(), axis.ticks = element_blank())
print(corr_heatmap)
# Save correlation plots
ggsave("Correlation_Annotated_Scatter.png", corr_plot, width = 6, height = 4)
ggsave("Correlation_Heatmap.png", corr_heatmap, width = 4, height = 4)
} else {
cat("\nNot enough valid observations for correlation test.\n")
}
# --- 9. Save Base Plots for Report ---
ggsave("Histogram_Ratings.png", p1, width = 6, height = 4)
ggsave("Scatter_Sentiment_vs_Rating.png", p2, width = 6, height = 4)
# 1. Load required packages
required_packages <- c("tidyverse", "stringr", "ggplot2", "ggpubr")
new_packages <- required_packages[!(required_packages %in% installed.packages()[,"Package"])]
if(length(new_packages)) install.packages(new_packages)
lapply(required_packages, library, character.only = TRUE)
# 2. Load dataset safely with encoding
dataset <- read.csv("McDonald_s_Reviews.csv", stringsAsFactors = FALSE, fileEncoding = "latin1")
# 3. Clean and prepare data
names(dataset) <- trimws(tolower(names(dataset)))
# Convert ratings like "4 stars" → numeric 4
dataset$rating <- str_extract(dataset$rating, "\\d+") %>% as.numeric()
# Keep valid rows
dataset <- dataset %>%
filter(!is.na(rating) & rating >= 1 & rating <= 5) %>%
filter(!is.na(review) & review != "")
dataset$review <- iconv(dataset$review, from = "latin1", to = "ASCII", sub = "")
# 4. Sentiment scoring using keyword matching
positive_words <- c("good","great","excellent","amazing","love","nice","tasty",
"clean","friendly","fast","happy","delicious","awesome","best","fresh", "quick", "accurate")
negative_words <- c("bad","terrible","awful","slow","hate","worst","dirty", "spit", "wrong",
"rude","cold","disappoint","poor","unhappy","unpleasant","stale","overpriced", "refused", "cheap")
dataset <- dataset %>%
mutate(
review_lower = tolower(review),
pos_count = sapply(review_lower, function(x) sum(str_count(x, positive_words))),
neg_count = sapply(review_lower, function(x) sum(str_count(x, negative_words))),
sentiment_score = pos_count - neg_count
)
# 5. Summaries
cat("\nValid reviews count:", nrow(dataset), "\n")
cat("\nSummary of numeric rating:\n")
print(summary(dataset$rating))
cat("\nSummary of sentiment scores:\n")
print(summary(dataset$sentiment_score))
# 6. Visualisations
# (a) Histogram of Ratings
p1 <- ggplot(dataset, aes(x = rating)) +
geom_histogram(binwidth = 1, fill = "steelblue", color = "black", boundary = 0.5) +
scale_x_continuous(breaks = seq(1, 5, 1)) +
labs(title = "Distribution of Customer Ratings",
x = "Rating (1–5 Stars)",
y = "Frequency") +
theme_minimal()
# (b) Scatter Plot of Sentiment vs Rating
p2 <- ggplot(dataset, aes(x = sentiment_score, y = rating)) +
geom_jitter(alpha = 0.5, color = "darkgreen") +
geom_smooth(method = "lm", se = TRUE, color = "red") +
labs(title = "Relationship Between Sentiment and Rating",
x = "Sentiment Score (Keyword-Based)",
y = "Rating (1–5 Stars)") +
theme_light()
print(p1)
print(p2)
# 7. Correlation Analysis
clean_data <- dataset %>% filter(!is.na(sentiment_score) & !is.na(rating))
if (nrow(clean_data) > 2) {
correlation_result <- cor.test(clean_data$sentiment_score, clean_data$rating, method = "pearson")
cat("\nPearson correlation test result:\n")
print(correlation_result)
# 8. Correlation Visualization
# (a) Annotated Scatter Plot with r and p-value
corr_text <- paste0("r = ", round(correlation_result$estimate, 3),
"\n p-value < ", format.pval(correlation_result$p.value, digits = 3))
corr_plot <- ggplot(clean_data, aes(x = sentiment_score, y = rating)) +
geom_point(alpha = 0.4, color = "blue") +
geom_smooth(method = "lm", color = "red", se = TRUE) +
annotate("text", x = Inf, y = Inf, label = corr_text, hjust = 1.1, vjust = 2,
size = 5, color = "black", fontface = "bold") +
labs(title = "Correlation Between Sentiment Score and Rating",
x = "Sentiment Score", y = "Rating (1–5 Stars)") +
theme_classic()
print(corr_plot)
# (b) Simple Correlation Heatmap
corr_matrix <- data.frame(sentiment_score = clean_data$sentiment_score,
rating = clean_data$rating)
corr_value <- round(cor(corr_matrix)[1, 2], 3)
corr_heatmap <- ggplot(data.frame(x = "Sentiment", y = "Rating", corr = corr_value),
aes(x = x, y = y, fill = corr)) +
geom_tile() +
geom_text(aes(label = corr), color = "white", size = 8, fontface = "bold") +
scale_fill_gradient2(low = "red", high = "blue", mid = "white",
midpoint = 0, limit = c(-1, 1)) +
labs(title = "Correlation Heatmap: Sentiment vs Rating",
x = "", y = "") +
theme_minimal() +
theme(axis.text = element_blank(), axis.ticks = element_blank())
print(corr_heatmap)
# Save correlation plots
ggsave("Correlation_Annotated_Scatter.png", corr_plot, width = 6, height = 4)
ggsave("Correlation_Heatmap.png", corr_heatmap, width = 4, height = 4)
} else {
cat("\nNot enough valid observations for correlation test.\n")
}
# 9. Save Base Plots for Report
ggsave("Histogram_Ratings.png", p1, width = 6, height = 4)
ggsave("Scatter_Sentiment_vs_Rating.png", p2, width = 6, height = 4)
# End of Script
# 1. Load required packages
required_packages <- c("tidyverse", "stringr", "ggplot2", "ggpubr")
new_packages <- required_packages[!(required_packages %in% installed.packages()[,"Package"])]
if(length(new_packages)) install.packages(new_packages)
lapply(required_packages, library, character.only = TRUE)
# 2. Load dataset safely with encoding
dataset <- read.csv("McDonald_s_Reviews.csv", stringsAsFactors = FALSE, fileEncoding = "latin1")
# 3. Clean and prepare data
names(dataset) <- trimws(tolower(names(dataset)))
# Convert ratings like "4 stars" → numeric 4
dataset$rating <- str_extract(dataset$rating, "\\d+") %>% as.numeric()
# Keep valid rows
dataset <- dataset %>%
filter(!is.na(rating) & rating >= 1 & rating <= 5) %>%
filter(!is.na(review) & review != "")
dataset$review <- iconv(dataset$review, from = "latin1", to = "ASCII", sub = "")
# 4. Sentiment scoring using keyword matching
positive_words <- c("good","great","excellent","amazing","love","nice","tasty",
"clean","friendly","fast","happy","delicious","awesome","best","fresh", "quick", "accurate")
negative_words <- c("bad","terrible","awful","slow","hate","worst","dirty", "spit", "wrong",
"rude","cold","disappoint","poor","unhappy","unpleasant","stale","overpriced", "refused", "cheap")
dataset <- dataset %>%
mutate(
review_lower = tolower(review),
pos_count = sapply(review_lower, function(x) sum(str_count(x, positive_words))),
neg_count = sapply(review_lower, function(x) sum(str_count(x, negative_words))),
sentiment_score = pos_count - neg_count
)
# 5. Summaries
cat("\nValid reviews count:", nrow(dataset), "\n")
cat("\nSummary of numeric rating:\n")
print(summary(dataset$rating))
cat("\nSummary of sentiment scores:\n")
print(summary(dataset$sentiment_score))
# 6. Visualisations
# (a) Histogram of Ratings
p1 <- ggplot(dataset, aes(x = rating)) +
geom_histogram(binwidth = 1, fill = "steelblue", color = "black", boundary = 0.5) +
scale_x_continuous(breaks = seq(1, 5, 1)) +
labs(title = "Distribution of Customer Ratings",
x = "Rating (1–5 Stars)",
y = "Frequency") +
theme_minimal()
# (b) Scatter Plot of Sentiment vs Rating
p2 <- ggplot(dataset, aes(x = sentiment_score, y = rating)) +
geom_jitter(alpha = 0.5, color = "darkgreen") +
geom_smooth(method = "lm", se = TRUE, color = "red") +
labs(title = "Relationship Between Sentiment and Rating",
x = "Sentiment Score (Keyword-Based)",
y = "Rating (1–5 Stars)") +
theme_light()
print(p1)
print(p2)
# 7. Correlation Analysis
clean_data <- dataset %>% filter(!is.na(sentiment_score) & !is.na(rating))
if (nrow(clean_data) > 2) {
correlation_result <- cor.test(clean_data$sentiment_score, clean_data$rating, method = "pearson")
cat("\nPearson correlation test result:\n")
print(correlation_result)
# 8. Correlation Visualization
# (a) Annotated Scatter Plot with r and p-value
corr_text <- paste0("r = ", round(correlation_result$estimate, 3),
"\n p-value < ", format.pval(correlation_result$p.value, digits = 3))
corr_plot <- ggplot(clean_data, aes(x = sentiment_score, y = rating)) +
geom_point(alpha = 0.4, color = "blue") +
geom_smooth(method = "lm", color = "red", se = TRUE) +
annotate("text", x = Inf, y = Inf, label = corr_text, hjust = 1.1, vjust = 2,
size = 5, color = "black", fontface = "bold") +
labs(title = "Correlation Between Sentiment Score and Rating",
x = "Sentiment Score", y = "Rating (1–5 Stars)") +
theme_classic()
print(corr_plot)
# (b) Simple Correlation Heatmap
corr_matrix <- data.frame(sentiment_score = clean_data$sentiment_score,
rating = clean_data$rating)
corr_value <- round(cor(corr_matrix)[1, 2], 3)
corr_heatmap <- ggplot(data.frame(x = "Sentiment", y = "Rating", corr = corr_value),
aes(x = x, y = y, fill = corr)) +
geom_tile() +
geom_text(aes(label = corr), color = "white", size = 8, fontface = "bold") +
scale_fill_gradient2(low = "red", high = "blue", mid = "white",
midpoint = 0, limit = c(-1, 1)) +
labs(title = "Correlation Heatmap: Sentiment vs Rating",
x = "", y = "") +
theme_minimal() +
theme(axis.text = element_blank(), axis.ticks = element_blank())
print(corr_heatmap)
# Save correlation plots
ggsave("Correlation_Annotated_Scatter.png", corr_plot, width = 6, height = 4)
ggsave("Correlation_Heatmap.png", corr_heatmap, width = 4, height = 4)
} else {
cat("\nNot enough valid observations for correlation test.\n")
}
# 9. Save Base Plots for Report
ggsave("Histogram_Ratings.png", p1, width = 6, height = 4)
ggsave("Scatter_Sentiment_vs_Rating.png", p2, width = 6, height = 4)
# 1. Load required packages
required_packages <- c("tidyverse", "stringr", "ggplot2", "ggpubr")
new_packages <- required_packages[!(required_packages %in% installed.packages()[,"Package"])]
if(length(new_packages)) install.packages(new_packages)
lapply(required_packages, library, character.only = TRUE)
# 2. Load dataset safely with encoding
dataset <- read.csv("McDonald_s_Reviews.csv", stringsAsFactors = FALSE, fileEncoding = "latin1")
# 3. Clean and prepare data
names(dataset) <- trimws(tolower(names(dataset)))
# Convert ratings like "4 stars" → numeric 4
dataset$rating <- str_extract(dataset$rating, "\\d+") %>% as.numeric()
# Keep valid rows
dataset <- dataset %>%
filter(!is.na(rating) & rating >= 1 & rating <= 5) %>%
filter(!is.na(review) & review != "")
dataset$review <- iconv(dataset$review, from = "latin1", to = "ASCII", sub = "")
# 4. Sentiment scoring using keyword matching
positive_words <- c("good","great","excellent","amazing","love","nice","tasty",
"clean","friendly","fast","happy","delicious","awesome","best","fresh", "quick", "accurate")
negative_words <- c("bad","terrible","awful","slow","hate","worst","dirty", "spit", "wrong",
"rude","cold","disappoint","poor","unhappy","unpleasant","stale","overpriced", "refused", "cheap")
dataset <- dataset %>%
mutate(
review_lower = tolower(review),
pos_count = sapply(review_lower, function(x) sum(str_count(x, positive_words))),
neg_count = sapply(review_lower, function(x) sum(str_count(x, negative_words))),
sentiment_score = pos_count - neg_count
)
# 5. Summaries
cat("\nValid reviews count:", nrow(dataset), "\n")
cat("\nSummary of numeric rating:\n")
print(summary(dataset$rating))
cat("\nSummary of sentiment scores:\n")
print(summary(dataset$sentiment_score))
# 6. Visualisations
# (a) Histogram of Ratings
p1 <- ggplot(dataset, aes(x = rating)) +
geom_histogram(binwidth = 1, fill = "steelblue", color = "black", boundary = 0.5) +
scale_x_continuous(breaks = seq(1, 5, 1)) +
labs(title = "Distribution of Customer Ratings",
x = "Rating (1–5 Stars)",
y = "Frequency") +
theme_minimal()
# (b) Scatter Plot of Sentiment vs Rating
p2 <- ggplot(dataset, aes(x = sentiment_score, y = rating)) +
geom_jitter(alpha = 0.5, color = "darkgreen") +
geom_smooth(method = "lm", se = TRUE, color = "red") +
labs(title = "Relationship Between Sentiment and Rating",
x = "Sentiment Score (Keyword-Based)",
y = "Rating (1–5 Stars)") +
theme_light()
print(p1)
print(p2)
# 7. Correlation Analysis
clean_data <- dataset %>% filter(!is.na(sentiment_score) & !is.na(rating))
if (nrow(clean_data) > 2) {
correlation_result <- cor.test(clean_data$sentiment_score, clean_data$rating, method = "pearson")
cat("\nPearson correlation test result:\n")
print(correlation_result)
# 8. Correlation Visualization
# (a) Annotated Scatter Plot with r and p-value
corr_text <- paste0("r = ", round(correlation_result$estimate, 3),
"\n p-value < ", format.pval(correlation_result$p.value, digits = 3))
corr_plot <- ggplot(clean_data, aes(x = sentiment_score, y = rating)) +
geom_point(alpha = 0.4, color = "blue") +
geom_smooth(method = "lm", color = "red", se = TRUE) +
annotate("text", x = Inf, y = Inf, label = corr_text, hjust = 1.1, vjust = 2,
size = 5, color = "black", fontface = "bold") +
labs(title = "Correlation Between Sentiment Score and Rating",
x = "Sentiment Score", y = "Rating (1–5 Stars)") +
theme_classic()
print(corr_plot)
# (b) Simple Correlation Heatmap
corr_matrix <- data.frame(sentiment_score = clean_data$sentiment_score,
rating = clean_data$rating)
corr_value <- round(cor(corr_matrix)[1, 2], 3)
corr_heatmap <- ggplot(data.frame(x = "Sentiment", y = "Rating", corr = corr_value),
aes(x = x, y = y, fill = corr)) +
geom_tile() +
geom_text(aes(label = corr), color = "white", size = 8, fontface = "bold") +
scale_fill_gradient2(low = "red", high = "blue", mid = "white",
midpoint = 0, limit = c(-1, 1)) +
labs(title = "Correlation Heatmap: Sentiment vs Rating",
x = "", y = "") +
theme_minimal() +
theme(axis.text = element_blank(), axis.ticks = element_blank())
print(corr_heatmap)
# Save correlation plots
ggsave("Correlation_Annotated_Scatter.png", corr_plot, width = 6, height = 4)
ggsave("Correlation_Heatmap.png", corr_heatmap, width = 4, height = 4)
} else {
cat("\nNot enough valid observations for correlation test.\n")
}
# 9. Save Base Plots for Report
ggsave("Histogram_Ratings.png", p1, width = 6, height = 4)
ggsave("Scatter_Sentiment_vs_Rating.png", p2, width = 6, height = 4)
# End of Script
corr_heatmap <- ggplot(data.frame(x = "Sentiment", y = "Rating", corr = corr_value),
aes(x = x, y = y, fill = corr)) +
geom_tile() +
geom_text(aes(label = corr), color = "white", size = 8, fontface = "bold") +
scale_fill_gradient2(low = "red", high = "blue", mid = "white",
midpoint = 0, limit = c(-1, 1)) +
labs(title = "Correlation Heatmap: Sentiment vs Rating",
x = "", y = "") +
theme_minimal() +
theme(axis.text = element_blank(), axis.ticks = element_blank())
print(corr_heatmap)
# Save correlation plots
ggsave("Correlation_Annotated_Scatter.png", corr_plot, width = 6, height = 4)
